#!/bin/sh

PIDFILES=/run/shm/lms2udp.*

# Check PIDs of PIDfiles and remove unused PIDs
if [ -e  $PIDFILES ] ; then
	for file in $PIDFILES
	do
		extension="${file##*.}"
		echo "Processing PID $extension"
		kill -n 0 $extension
		if [ $? -ne 0 ] ; then
			rm -f $file
		fi
	done
fi

# If no PID was remaining, restart LMS2UDP
if [ ! -e  $PIDFILES ] ; then
	# Starting LMS2UDP
	REPLACEINSTALLFOLDER/webfrontend/cgi/plugins/REPLACEFOLDERNAME/restart_lms2udp.sh & 1> /dev/null 2> REPLACEINSTALLFOLDER/log/plugins/REPLACEFOLDERNAME/start_lms2udp.log
fi
